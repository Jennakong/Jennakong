<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>When Life Gives You Lemon</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&family=DM+Serif+Display&display=swap" rel="stylesheet">

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

<!-- Three.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r155/three.min.js"></script>

<style>
  /* General Body */
  body {
    margin: 0;
    font-family: 'Quicksand', sans-serif;
    overflow-x: hidden;
    background: #bde3ff;
  }

  /* Lemon Experience Container */
  #lemon-experience {
    position: relative;
    width: 100%;
    height: 100vh;
    overflow: hidden;
    background: linear-gradient(to bottom, #bde3ff 0%, #fff6cc 100%);
  }

  /* Three.js Canvas */
  #three-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  /* Overlay text */
  #lemon-experience .overlay {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  .text-stage {
    position: absolute;
    bottom: 30%;
    width: 100%;
    text-align: center;
    color: #1e1e1e;
  }

  .headline-main {
    font-size: 3.2rem;
    font-weight: 500;
    letter-spacing: -1px;
    opacity: 0;
    transform: translateY(20px);
  }

  .headline-sub,
  .headline-question {
    font-size: 1.3rem;
    font-weight: 300;
    margin-top: 12px;
    opacity: 0;
    transform: translateY(20px);
  }

  /* Form Section */
  .form-section {
    position: absolute;
    bottom: -100%;
    width: 100%;
    padding: 80px 20px;
    background: white;
    text-align: center;
    transition: bottom 1.2s cubic-bezier(.77,0,.18,1);
  }

  .form-title {
    font-size: 2rem;
    margin-bottom: 10px;
  }

  .form-subtitle {
    opacity: 0.6;
    margin-bottom: 40px;
  }

  .form-section input,
  .form-section textarea {
    width: 60%;
    padding: 15px;
    margin: 10px 0;
    border-radius: 12px;
    border: 1px solid #ddd;
    font-size: 1rem;
  }

  .form-section button {
    padding: 12px 30px;
    background: #f4c430;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 500;
  }
</style>
</head>

<body>
<section id="lemon-experience">

  <!-- Audio -->
  <audio id="birds" loop>
    <source src="birds.mp3" type="audio/mpeg">
  </audio>

  <!-- Three.js Scene -->
  <div id="three-container"></div>

  <!-- Overlay Text -->
  <div class="overlay">
    <div class="text-stage">
      <h1 class="headline-main">When life gives you lemon</h1>
      <h2 class="headline-sub">They told us to make lemonade.</h2>
      <h2 class="headline-question">We're not convinced.</h2>
    </div>
  </div>

  <!-- Form Section -->
  <div class="form-section">
    <h3 class="form-title">So tell us...</h3>
    <p class="form-subtitle">When life gives you lemon, what do you do?</p>
    <form id="lemonForm">
      <input type="text" placeholder="Your name or what you go by" required>
      <input type="text" placeholder="Country" required>
      <textarea placeholder="When life gives you lemon, I..." required></textarea>
      <button type="submit">Submit</button>
    </form>
  </div>

</section>

<script>
  // GSAP ScrollTrigger registration
  gsap.registerPlugin(ScrollTrigger);

  // THREE.js Scene Setup
  const scene = new THREE.Scene();

  const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
  camera.position.z = 8;

  const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.getElementById("three-container").appendChild(renderer.domElement);

  // Light
  const light = new THREE.DirectionalLight(0xffffff, 1.5);
  light.position.set(5, 10, 7);
  scene.add(light);

  // Tree (Simplified Premium Foliage)
  const treeGeometry = new THREE.SphereGeometry(3, 64, 64);
  const treeMaterial = new THREE.MeshStandardMaterial({ color: 0x3e6b2f });
  const tree = new THREE.Mesh(treeGeometry, treeMaterial);
  tree.position.y = -1;
  scene.add(tree);

  // Lemon
  const lemonGeometry = new THREE.SphereGeometry(0.5, 64, 64);
  const lemonMaterial = new THREE.MeshStandardMaterial({ color: 0xf4c430, roughness: 0.4 });
  const lemon = new THREE.Mesh(lemonGeometry, lemonMaterial);
  lemon.position.set(1.2, 1.5, 0);
  scene.add(lemon);

  // Wind sway animation
  gsap.to(tree.rotation, { z: 0.05, duration: 3, repeat: -1, yoyo:true, ease:"sine.inOut" });

  // Lemon drop with bounce
  setTimeout(() => {
    gsap.to(lemon.position, {
      y: -3,
      duration: 1.5,
      ease: "bounce.out",
      onComplete: crackLemon
    });
  }, 3000);

  // Crack lemon + seed scatter
  function crackLemon() {
    lemon.material.color.set(0xe0b22e);

    for (let i=0; i<20; i++) {
      const seedGeometry = new THREE.SphereGeometry(0.05, 8, 8);
      const seedMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
      const seed = new THREE.Mesh(seedGeometry, seedMaterial);
      seed.position.copy(lemon.position);
      scene.add(seed);

      gsap.to(seed.position, {
        x: (Math.random()-0.5)*4,
        y: -4,
        z: (Math.random()-0.5)*2,
        duration: 2,
        ease: "power2.out"
      });
    }

    revealTextSequence();
    revealForm();
  }

  // Text reveal sequence
  function revealTextSequence() {
    gsap.to(".headline-main", { opacity:1, y:0, duration:1.5, ease:"power3.out" });
    gsap.to(".headline-sub", { opacity:1, y:0, duration:1.5, delay:1.5, ease:"power3.out" });
    gsap.to(".headline-question", { opacity:1, y:0, duration:1.5, delay:3, ease:"power3.out" });
  }

  // Form reveal
  function revealForm() {
    document.querySelector(".form-section").style.bottom = "0";
  }

  // Play birds audio on first click
  const birds = document.getElementById("birds");
  window.addEventListener("click", () => { birds.play(); });

  // Animate scene
  function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
  }
  animate();

  // Resize
  window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

  // Form submission (for now, just prevent default)
  document.getElementById("lemonForm").addEventListener("submit", (e)=>{
    e.preventDefault();
    alert("Your lemon has been planted. When it becomes something, we will let you know.");
    e.target.reset();
  });

</script>
</body>
</html>